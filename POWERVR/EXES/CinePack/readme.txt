Cinepack.exe β26版 for Windows95
Saturn CinePack -> Video for Windows Cinepack +α

[機能]
セガサターンのCPK,CAKのシネパックムービーをWindowsのAVIに変換する。
CRI ADXを直接再生。または、WindowsのWaveファイルに変換する。

[使い方]
（WindowsのAVIに変換）
ムービーをコンバートするときは「コンバート」ボタン（またはファイルメニュー
から選択）を使ってください。
音楽用のパネルが出ているときには「閉じる」ボタンでパネルを閉じてから、
「コンバート」ボタンを使ってください。（後述のものと機能がぶつかるため）
その後、しばらくして保存先を聞いてきますので、保存先とファイル名を指定して
ください。このとき保存先に空き容量があるかどうかはかんがえておりませんので、
十分な空き容量がある場所に保存してください。
拡張子がCAKのものは、一度テンポラリファイルを作成しますので、その容量も
計算にいれてください。テンポラリの保存先はオプションで変えることができます。
映像と音声をインターリーブしている関係上、CPKでも元のファイルより若干
大きくなります。

（CRI ADXを直接再生  WindowsのWaveファイルに変換）
音声を再生するときは「開く」ボタン（またはファイルメニューから選択）を使って
ください。ダイアログがでますので、再生したいファイルを指定してください。
現在音声が再生できるのは、ADX、ACX、CAK、STZの仕様のものだけです。
音楽用のパネルが表示されますので、あとは再生ボタンで再生すれば、音が鳴ります。
ACX、STZに関しては１つのファイルに複数の音が含まれていますので、右にでてくる
インデックスの数字を指定してから再生してください。
キーボードでは上下左右がインデックスの増減、Enterが再生、停止のトグルになって
います。このとき、「コンバート」ボタンで、現在開いてる音声ファイルをWAVEに
変換できます。
保存先を聞いてきますので、ムービーのコンバート同様、保存先とファイル名を指定して
保存してください。（ACXの場合にはインデックスがデフォルトファイル名に追加され
ます。）
STZは、自動解析しますので、開くまで時間がかかります。

（オプションについて）
「オプション」ボタンは、主にADXについてのオプションです。
第一第二フィルタの調整と音声増幅の倍率、テンポラリの保存先、
CAK変換時に音声のみを変換するかどうかが指定できます。
現在、フィルタの値は私の勝手な判断ですので、いろいろ試してみてください。
（思い通りの音になるというほどの変更はできませんが(^^;）
第一は高音域の抑え、第二第三は一応フィルタ２タップの係数変更です。
デフォルトは、第一第二第三フィルタが1、音量中です。
高音が強いと思われたら第一を増やしてください。

 ADX再生中にオーバーフローのチェックをできるように変更しました。
 デフォルトで、まずオーバーフローしないと思いますが、可能性として
 オーバーフローするものもあるかもしれませんので、一応。

 CD-ROM用のフレーム補完については、CD-ROMのシークにあわせてフレームを
 補完するもので、ファイルがその分でかくなりますので、注意してください。

 β１８からイニシャライズファイルを利用してますので、前回のオプションがそのまま
 残ります。必要があれば、変更をしてください。

 ヘッダーの自動解析は、拡張子ADXのファイルに複数のADXが含まれてるかどうかを
 自動的に調べるものです。ヘッダーの数字が、ゲームによって意味が違うので、
 サクラ大戦２にしか対応してません。というより今のところサクラ大戦２、
 グランディアでしか、この形式はありませんので。。。
 
 音声のみの変換については、名前は指定できず、テンポラリ保存先に元の
 ファイルネームの拡張子を変えたWAVがつくられます。

 外部から音声を取り込むようにしました。まだ暫定的なものですので、不具合がある
 かもしれません。一応代表的なWAVEフォーマット(PCM,MS-ADPCM,IMA-ADPCM,
 CCITT A-Law･u-Law,GSM611とか)で実験しましたが、すべて調べたわけではないので、
 どうなるか不明なものもあります。。。(^^;

 インターリーブするときに音声をどれだけずらすかを指定できます。
 あまり意味はないかもしれませんが、いろいろ試して見てください。

[備考]
音声のフォーマットの変更についてですが、こちらで圧縮ルーチンを
用意するよりは外部アプリに任せて、各自で連結していただくという
方法を取りたいと思います。
AVIでもCODECさえ入っていればRIFFのMP3とか使えますので、
そちらを利用した方がよりファイルが小さく、音もきれいに
鳴らせますので、、、(^^;

インターリーブについては、ファイルが少し大きくなりますが、マシンの性能をフルに
発揮するために、多少のファイルサイズは犠牲にしております。
（AVIの名前の由来がAudioVideoInterleaveというくらいですので(^^;）
インターリーブは、このソフトの当初からの基本になってますので、これは変えないと
思います。

再生時のループは、ループできるものはすべてループします。
放っておくと永久にとまりませんので、注意してください。
ゲーム中ではループしてないにもかかわらず、ループしてしまうものがありますが、
これはヘッダーに忠実にループしているためです(^^;
WAVEコンバート時はおよそ１回分を保存します。

ファイルのシークは、スクロールバーのドラッグによる移動しか対応してません。

［おまけ］
拡張子が違うが実際は.ACXのもの。
（対応ファイルに入ってますので「開く」で選択可能です）

ギレンの野望			00000003.bin(ゲーム中のセリフ)

サクラ大戦２			\SAKURA1\ADVADX1.VCE(ゲーム中のセリフ)
				\SAKURA1\ADVADX2.VCE(ゲーム中のセリフ)
				\SAKURA1\ADVADX3.VCE(ゲーム中のセリフ)

[履歴]
1997/ 6/27 β2版	1998/ 1/12 β3版
1998/ 4/29 β4版	1998/ 4/29 β5版
1998/ 5/ 2 β6版	1998/ 5/ 2 β7版
1998/ 5/ 4 β8版	1998/ 5/ 7 β9版
1998/ 5/10 β10版	1998/ 5/11 β11版
1998/ 5/13 β12版	1998/ 5/13 β13版
1998/ 5/14 β14版	1998/ 5/19 β15版
1998/ 5/22 β16版	1998/ 5/25 β17版
1998/ 6/ 3 β18版
 
1998/ 6/ 6 β19版
 再生、コンバートで拡張子.STZに対応。
 （グランディア、グランディアデジタルミュージアム \Field\GM*.STZ）
 同じくサクラ大戦２の複合ADXに対応。（オプションの「ヘッダーの自動解析」）
 再生時ファイルのシーク、ポジション表示対応。
 細かいバグを修正。
 
1998/ 6/ 16 β20版
 表示系バグつぶし。アプリのアイコンを作ってみる。
 再生中のシークで、ステレオの場合、左右がずれることがあったのを修正。
 一応、ファイルのドラッグアンドドロップに対応。
 ウィンドウに対してのドラッグは未対応。
 音量のアップの２倍をやめ、１６倍に変更。
 CPK＆CAKのオプションで音声を残すのではなく、音声のみの変換に変更。
 CPK＆CAK変換時に外部からWAVEファイルを取り込めるようにした。

1998/ 6/ 17 β21版
 表示系改良。
 β６くらいでやめてたフレームが不均等なCPKに対しての対処を戻す。
 （クオヴァディス、エヴァ等）
 外部音声の取り込みがうまく行かない場合があったのを修正。

1998/ 6/ 19 β22版
 バグ修正。
 時間表示改良。

1998/ 6/ 24 β23版
 idxチャンクの計算のバグを修正。
 インターリーブをずらせるように修正。

1998/ 12/ 6 β24版
 フィルタを変更。

1998/ 12/ 8 β25版
 フィルタをさらに変更。

1998/  3/ 1 β26版
 不均等なフレームがある場合、フレームを最適化するように修正。
 （その分AVIのサイズは増加）
 拡張子が違うCAKもきちんと選別するようにした。（すべてのファイルから選択）
 その他細かい見直し。

このプログラムは、私が個人的に作ってるものです。
SEGAやCRIとは関係が無いので、ご注意ください。
データは個人的鑑賞にのみ使ってください。
転載は禁止、、、ということにしといてください
							lcm@interlink.or.jp
							Ｌ．Ｃ．Ｍ
