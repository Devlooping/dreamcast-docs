LATENCY: Measures Multimedia Timer Latency

LATENCY measures latency of multimedia timer callbacks under Windows 95
and Windows NT. When running under Windows 95 you can choose to use
either a 32-bit or 16-bit timer procedure. Using a 16-bit timer
procedure will reduce multimedia timer latency under Windows 95.
Windows NT requires 32-bit timer procedures. LATENCY will not run on
the Win32s platform because Win32s does not support multimedia timers.

LATENCY also illustrates how Windows 95 applications can call
procedures in a 16-bit DLL using a technique called flat thunking.

Note: This application is not designed to be a precise system
measurement tool--it is designed to illustrate problems commonly
encountered with MIDI sequencer applications under Windows 95.

The LATENCY sample consists of the following targets: LATENCY.EXE,
TIMER16.DLL, TIMER32.DLL, and THK3216.DLL. TIMER16.DLL was built using
the 16-bit version of VC++ (I used version 1.52) using the TIMER16.MAK
makefile. The remaining targets were built with the 32-bit version of
VC++ (I used version 4.0) using the LATENCY.MAK makefile. In addition
to 16-bit and 32-bit compilers, LATENCY requires an assembler (I used
MASM 6.11), the Windows 95 Thunk Compiler (I used version 1.8), and
version 4.0 of the Resource Compiler. The Thunk Compiler and Resource
Compiler are available in the Win32 SDK. Version 4.0 of the Resource
Compiler is required to mark the 16-bit DLL as a Windows 4.0 executable.

To build the LATENCY sample application:

1.  (Optional) Build the thunks (THK16.OBJ and THK32.OBJ) by running the
    MAKETHK.BAT batch file. The assembler and thunk compiler must be in
    your PATH.

    These object files are included with the sample so that you can skip
    this step. You don't have to rebuild the object files unless you
    change the signature of one of the thunked functions.

2.  Build the 16-bit DLL, TIMER16.DLL, using the TIMER16.MAK makefile.

3.  Mark the 16-bit DLL for use with Windows 95 by running the
    MARK40.BAT batch file.

4.  Build the 32-bit DLL, TIMER32.DLL, using the TIMER32.MAK makefile.

KEYWORDS: MIDI; sequencer; timer; thunk; latency
