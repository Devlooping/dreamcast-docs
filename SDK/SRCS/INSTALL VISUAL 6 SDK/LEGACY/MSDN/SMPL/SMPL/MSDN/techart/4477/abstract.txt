WRAPUSER: Calls COM Objects with Interface Wrappers
WRAPUSER is a companion sample for the "Calling COM Objects with Interface Wrappers" technical 
article in the Microsoft(R) Development Library.
The WRAPUSER sample application demonstrates how to use Component Object Model (COM) interface 
wrappers. COM interface wrappers are classes that contain a pointer to a COM interface and forward calls 
to the COM object. The interface wrappers are implemented in CInterfaceWrap.h, which includes 
implementations for CInterfaceWrap and CUnknownWrap. CSimpleWrap implements the interface wrapper 
for the ISimple interface and inherits from CInterfaceWrap. The ISimple interface is implemented in 
SimpleObject.dll.
WRAPUSER allows you to create SimpleObject COM objects, call the Inc function in the ISimple 
interface, and release the object.
Before WRAPUSER will work, you must register the SimpleObject object. First, edit the paths in 
SimpleObject.reg to point to the location of the SimpleObject.dll. Then double-click SimpleObject.reg to 
add it to the registry.
This project builds both WrapUser.exe and SimpleObject.dll, and requires Microsoft Visual C++(TM) 
version 4.0 to run.
This sample was built with Microsoft Visual C++ version 4.0, and was tested on Microsoft Windows 
NT(TM) version 3.51.
SIMPLEOBJECT KEYWORDS: CD14; DllCanUnloadNow; DllGetClassObject; 
IClassFactory::CreateInstance; IClassFactory::LockServer; IUnknown::AddRef; 
IUnknown::QueryInterface; IUnknown::Release; InterlockedDecrement; InterlockedIncrement
WRAPUSER KEYWORDS: CD14; AfxGetApp; AfxMessageBox; AfxOleInit; CDC::DrawIcon; 
CDC::GetSafeHdc; CDialog::DoModal; CDialog::OnCancel; CDialog::OnOK; CListBox::AddString; 
CListBox::DeleteString; CListBox::GetCurSel; CListBox::GetItemData; CListBox::SetCurSel; 
CListBox::SetItemData; CMenu::AppendMenu; CRect::Height; CRect::Width; CString::Format; 
CString::IsEmpty; CString::LoadString; CWinApp::Enable3dControls; CWinApp::InitInstance; 
CWinApp::RunAutomated; CWinApp::RunEmbedded; CWnd::Attach; CWnd::DoDataExchange; 
CWnd::EnableWindow; CWnd::GetClientRect; CWnd::IsIconic; CWnd::OnPaint; 
CWnd::OnQueryDragIcon; CWnd::OnSysCommand; CWnd::SendMessage; CWnd::SetWindowText; 
CoCreateInstance; GetSystemMenu; GetSystemMetrics; LoadIcon



