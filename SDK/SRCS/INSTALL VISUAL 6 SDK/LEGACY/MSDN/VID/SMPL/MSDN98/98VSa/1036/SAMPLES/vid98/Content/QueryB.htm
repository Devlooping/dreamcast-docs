<HTML>
<HEAD>
<META NAME="GENERATOR" Content="Microsoft Visual Studio 6.0">
</HEAD>
<BODY bgColor=#ffffff leftMargin=40 link=#500000 vLink=#505050>
<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>
<FONT SIZE=4 COLOR=#500000>L'envers du d&#233;cor</FONT>
<BR><BR>

<P>Cet exemple utilise un seul fichier : Query.asp. D&#232;s que l'utilisateur entre 
les crit&#232;res de recherche, les r&#233;sultats s'affichent &#224; l'aide d'une grille d&#233;pendante. 
</P>

<P>Pour cr&#233;er la requ&#234;te dynamique, il faut appeler une fonction 
afin de d&#233;finir l'instruction SQL pour le jeu d'enregistrements. La fonction d&#233;termine d'abord si 
l'utilisateur a s&#233;lectionn&#233; CONTAINS ou BEGINS WITH dans la premi&#232;re liste d&#233;roulante, puis 
reconstruit l'instruction SQL. </P>

<P>La nouvelle instruction SQL est envoy&#233;e au jeu d'enregistrements et le nouveau 
jeu d'enregistrements est ouvert. La fonction ci-dessous montre le code qui est ex&#233;cut&#233; une 
fois que l'utilisateur a cliqu&#233; sur le bouton Rechercher : </P>

<FONT FACE="Courier">
<P>function Button1_onclick() { <BR>&nbsp;&nbsp; if (Listbox2.getValue(Listbox2.selectedIndex) == 
&quot;Contains&quot;) { <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 
newSQL = &quot;Select * FROM Customers WHERE (&quot; + 
Listbox1.getValue(Listbox1.selectedIndex) + &quot; LIKE '%&quot; + 
Textbox1.value + &quot;%')&quot;; } else { newSQL = &quot;Select * FROM 
Customers WHERE (&quot; + Listbox1.getValue(Listbox1.selectedIndex) + &quot; 
LIKE '&quot; + Textbox1.value + &quot;%')&quot;; } <BR>&nbsp;&nbsp; DTCRecordset1.setSQL(newSQL); <BR>&nbsp;&nbsp; DTCRecordset1.open(); <BR>
} </P>
</FONT>

<P>Une fois le jeu d'enregistrements ouvert, les r&#233;sultats sont affich&#233;s &#224; l'aide d'une grille d&#233;pendante. Cette grille affiche les donn&#233;es dans des pages contenant 
dix enregistrements chacune.</P></FONT>

</BODY>
</HTML>
