<HTML>
<HEAD>
<META NAME="GENERATOR" Content="Microsoft Visual Studio 6.0">
</HEAD>
<BODY bgColor=#ffffff leftMargin=40 link=#500000 vLink=#505050>
<FONT FACE="Verdana, Arial, Helvetica" SIZE=2>
<FONT SIZE=4 COLOR=#500000>L'envers du d&#233;cor</FONT>
<BR><BR>
<P>Cet exemple utilise un seul fichier : Quote.asp. Ce fichier 
g&#233;n&#232;re un nombre al&#233;atoire bas&#233; sur le nombre total de citations dans la table Quote 
et d&#233;place le pointeur de l'enregistrement dans le jeu d'enregistrements sur ce nombre al&#233;atoire. </P>
<P>Une fois que le jeu d'enregistrements a ouvert la table, un sous-programme Visual Basic, 
Scripting Edition (VBScript), est ex&#233;cut&#233; pour g&#233;n&#233;rer le nombre al&#233;atoire. Le sous-programme 
utilise la m&#233;thode Recordset.getCount pour d&#233;terminer le nombre 
d'enregistrements dans le jeu d'enregistrements. </P>
<P>Une fois le nombre al&#233;atoire g&#233;n&#233;r&#233;, le pointeur de l'enregistrement 
dans le jeu d'enregistrements est d&#233;plac&#233; &#224; l'aide de la m&#233;thode Recordset.moveAbsolute. Le code ci-dessous pr&#233;sente la proc&#233;dure ex&#233;cut&#233;e : 
 </P>
<FONT face=Courier>
<P>Sub QuoteRecordset_ondatasetcomplete() <BR>&nbsp;&nbsp; Randomize() <BR>&nbsp;&nbsp; intQuote 
= Int((QuoteRecordset.getCount()) * Rnd + 1) <BR>&nbsp;&nbsp; QuoteRecordset.moveAbsolute(intQuote) <BR>
End sub </P>
</FONT>
<P>La citation et l'auteur sont affich&#233;s &#224; l'aide de deux &#233;tiquettes d&#233;pendantes. La premi&#232;re est li&#233;e au champ de la citation et la seconde 
au champ de l'auteur.</P></FONT>
</BODY>
</HTML>
